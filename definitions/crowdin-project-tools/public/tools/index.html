<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project Tools App</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.crowdin.com/apps/dist/iframe.js" defer></script>
    <script src="app.js" defer></script>
</head>
<body>
    <!-- Main Container -->
    <div class="container" role="main">
        <h1>üõ†Ô∏è Project Tools Demo</h1>
        
        <!-- Introduction Section -->
        <div class="tool-section">
            <h3>üöÄ Welcome to Crowdin Project Tools Template</h3>
            <p>This template demonstrates a fully functional Crowdin app with <strong>Project Tools</strong> module integration.</p>
            
            <div class="context-info">
                <strong>üìå About Project Tools:</strong><br>
                Project Tools apps appear in the project menu and provide project-specific functionality. They have access to project context, languages, files, and can perform operations via Crowdin API.
            </div>
            
            <h4>What's Included in This Template:</h4>
            <ul class="feature-list">
                <li><strong>Crowdin Apps JS API</strong> - Official SDK integration with AP object</li>
                <li><strong>Express.js Backend</strong> - Server with Crowdin SDK (@crowdin/app-project-module)</li>
                <li><strong>JWT Authentication</strong> - Secure token-based authentication</li>
                <li><strong>Project Context Access</strong> - Automatic project ID, organization ID, user ID</li>
                <li><strong>API Examples</strong> - Ready-to-use endpoints for common operations</li>
                <li><strong>TypeScript Support</strong> - Type-safe backend development</li>
            </ul>

            <div class="info-box">
                <strong>üí° Getting Started:</strong><br>
                1. Explore the sections below to see the app in action<br>
                2. Check <code>app.js</code> for frontend code<br>
                3. Review <code>worker/app.ts</code> for backend API endpoints<br>
                4. Customize the UI and add your business logic
            </div>
        </div>

        <!-- Project Context Section -->
        <div class="tool-section" role="region" aria-labelledby="project-context-heading">
            <h3 id="project-context-heading">üìä Current Project Context</h3>
            <p>This section displays information retrieved via <code>AP.getContext()</code></p>
            <div id="projectInfo" class="loading" role="status" aria-live="polite">Loading project information...</div>
            
            <div class="code-snippet">
                <strong>Code Example:</strong><br>
                AP.getContext(function(context) {<br>
                &nbsp;&nbsp;console.log('Project ID:', context.project_id);<br>
                &nbsp;&nbsp;console.log('Organization ID:', context.organization_id);<br>
                &nbsp;&nbsp;console.log('User ID:', context.user_id);<br>
                });
            </div>
        </div>

        <!-- Project Languages Section -->
        <div class="tool-section" role="region" aria-labelledby="languages-heading">
            <h3 id="languages-heading">üåç Project Languages</h3>
            <p>Languages loaded from backend API endpoint: <code>GET /api/project-languages</code></p>
            <div id="languageInfo" class="loading" role="status" aria-live="polite">Loading languages...</div>
            
            <div class="code-snippet">
                <strong>Backend Code (worker/app.ts):</strong><br>
                const projectResponse = await client.projectsGroupsApi.getProject(projectId);<br>
                const targetLanguageIds = projectResponse.data.targetLanguageIds;<br>
                const supportedLanguages = await client.languagesApi.withFetchAll().listSupportedLanguages();
            </div>
        </div>

        <!-- Actions Section -->
        <div class="tool-section" role="region" aria-labelledby="actions-heading">
            <h3 id="actions-heading">‚ö° Project Actions</h3>
            <p>Example buttons that trigger backend API calls to <code>POST /api/project-action</code></p>
            
            <div style="margin: 20px 0;" role="group" aria-label="Project actions">
                <button class="action-button" 
                        onclick="performAction('analyze')" 
                        aria-label="Analyze project data and statistics">
                    üìà Analyze Project
                </button>
                <button class="action-button" 
                        onclick="performAction('export')" 
                        aria-label="Export project data to file">
                    üíæ Export Data
                </button>
                <button class="action-button" 
                        onclick="performAction('sync')" 
                        aria-label="Synchronize project with external sources">
                    üîÑ Sync Project
                </button>
                <button class="action-button" 
                        onclick="performAction('report')" 
                        aria-label="Generate project report">
                    üìã Generate Report
                </button>
            </div>
            
            <div id="actionResult" role="status" aria-live="polite"></div>
            
            <div class="code-snippet">
                <strong>Frontend Code (app.js):</strong><br>
                async function performAction(action) {<br>
                &nbsp;&nbsp;const response = await fetch(`/api/project-action?jwt=${jwtToken}`, {<br>
                &nbsp;&nbsp;&nbsp;&nbsp;method: 'POST',<br>
                &nbsp;&nbsp;&nbsp;&nbsp;body: JSON.stringify({ action, projectId })<br>
                &nbsp;&nbsp;});<br>
                }
            </div>
        </div>

        <!-- API Reference Section -->
        <div class="tool-section" role="region" aria-labelledby="api-reference-heading">
            <h3 id="api-reference-heading">üìö Available Crowdin Apps JS API Methods</h3>
            <table class="data-table" role="table" aria-label="Crowdin Apps JS API methods reference">
                <thead>
                    <tr>
                        <th>Method</th>
                        <th>Description</th>
                        <th>Usage</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>AP.getContext(callback)</code></td>
                        <td>Get project context information</td>
                        <td><span class="badge success">Used</span></td>
                    </tr>
                    <tr>
                        <td><code>AP.getJwtToken(callback)</code></td>
                        <td>Get JWT token for API calls</td>
                        <td><span class="badge success">Used</span></td>
                    </tr>
                    <tr>
                        <td><code>AP.redirect(path)</code></td>
                        <td>Navigate to different Crowdin page</td>
                        <td><span class="badge info">Available</span></td>
                    </tr>
                    <tr>
                        <td><code>AP.events.on(event, callback)</code></td>
                        <td>Listen to Crowdin events</td>
                        <td><span class="badge info">Available</span></td>
                    </tr>
                </tbody>
            </table>
            
            <p style="margin-top: 15px;">
                üìñ <strong>Full API Documentation:</strong> 
                <a href="https://support.crowdin.com/developer/crowdin-apps-js" target="_blank">
                    https://support.crowdin.com/developer/crowdin-apps-js
                </a>
            </p>
        </div>

        <!-- Implementation Guide -->
        <div class="tool-section">
            <h3>üîß Implementation Guide</h3>
            
            <h4>Frontend (app.js):</h4>
            <div class="code-snippet">
                ‚Ä¢ Use <code>AP.getContext()</code> to get project information<br>
                ‚Ä¢ Use <code>AP.getJwtToken()</code> to authenticate API calls<br>
                ‚Ä¢ Make requests to your backend endpoints with JWT token<br>
                ‚Ä¢ Update UI based on responses
            </div>

            <h4>Backend (worker/app.ts):</h4>
            <div class="code-snippet">
                ‚Ä¢ Initialize Crowdin SDK with <code>addCrowdinEndpoints()</code><br>
                ‚Ä¢ Use <code>establishCrowdinConnection(jwt)</code> to authenticate<br>
                ‚Ä¢ Access Crowdin API via <code>client.projectsGroupsApi</code>, etc.<br>
                ‚Ä¢ Return data to frontend via Express endpoints
            </div>

            <h4>Next Steps:</h4>
            <ul class="feature-list">
                <li>Customize the UI in <code>index.html</code> and <code>styles.css</code></li>
                <li>Add your business logic in <code>app.js</code></li>
                <li>Create new API endpoints in <code>worker/app.ts</code></li>
                <li>Test your app in Crowdin project</li>
                <li>Deploy to Cloudflare Workers and install it in your Crowdin account</li>
            </ul>

            <div class="info-box">
                <strong>üéØ Pro Tips:</strong><br>
                ‚Ä¢ Keep the UI simple and focused on your app's main functionality<br>
                ‚Ä¢ Use the Crowdin API efficiently - cache data when possible<br>
                ‚Ä¢ Handle errors gracefully and show user-friendly messages<br>
                ‚Ä¢ Test with different project sizes and configurations
            </div>
        </div>
    </div>
</body>
</html>
