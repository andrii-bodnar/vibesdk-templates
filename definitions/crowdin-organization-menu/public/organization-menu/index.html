<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Organization Menu App</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.crowdin.com/apps/dist/iframe.js" defer></script>
    <script src="app.js" defer></script>
</head>
<body>
    <!-- Main Container -->
    <div class="container" role="main">
        <h1>üè¢ Organization Menu Demo</h1>
        
        <!-- Introduction Section -->
        <div class="tool-section">
            <h3>üöÄ Welcome to Crowdin Organization Menu Template</h3>
            <p>This template demonstrates a fully functional Crowdin app with <strong>Organization Menu</strong> module integration.</p>
            
            <div class="context-info">
                <strong>üìå About Organization Menu:</strong><br>
                Organization Menu apps appear in the organization-level navigation menu and provide organization-wide functionality. They have access to all organization projects, groups, members, and can perform operations via Crowdin API.
            </div>
            
            <h4>What's Included in This Template:</h4>
            <ul class="feature-list">
                <li><strong>Crowdin Apps JS API</strong> - Official SDK integration with AP object</li>
                <li><strong>Express.js Backend</strong> - Server with Crowdin SDK (@crowdin/app-project-module)</li>
                <li><strong>JWT Authentication</strong> - Secure token-based authentication</li>
                <li><strong>Organization Context</strong> - Automatic organization ID, user ID access</li>
                <li><strong>Groups & Projects</strong> - Real-time organization structure display</li>
                <li><strong>TypeScript Support</strong> - Type-safe backend development</li>
            </ul>

            <div class="info-box">
                <strong>üí° Getting Started:</strong><br>
                1. Explore the sections below to see the app in action<br>
                2. Check <code>app.js</code> for frontend code<br>
                3. Review <code>worker/app.ts</code> for backend API endpoints<br>
                4. Customize the UI and add your business logic
            </div>
        </div>

        <!-- Organization Context Section -->
        <div class="tool-section" role="region" aria-labelledby="org-context-heading">
            <h3 id="org-context-heading">üìä Current Organization Context</h3>
            <p>This section displays information retrieved via <code>AP.getContext()</code></p>
            <div id="orgInfo" class="loading" role="status" aria-live="polite">Loading organization information...</div>
            
            <div class="code-snippet">
                <strong>Code Example:</strong><br>
                AP.getContext(function(context) {<br>
                &nbsp;&nbsp;console.log('Organization ID:', context.organization_id);<br>
                });
            </div>
        </div>

        <!-- Projects by Groups Section -->
        <div class="tool-section" role="region" aria-labelledby="projects-heading">
            <h3 id="projects-heading">üìÇ Projects Organized by Groups</h3>
            <p>Projects loaded from backend API endpoint: <code>GET /api/projects-by-groups</code></p>
            <p style="font-size: 0.95rem; color: #6c757d;">Click "Load Projects" to see the organization structure with groups and projects.</p>
            
            <div style="margin: 20px 0;" role="group" aria-label="Project actions">
                <button class="action-button" 
                        onclick="loadProjectsByGroups()" 
                        aria-label="Load projects organized by groups">
                    üìä Load Projects by Groups
                </button>
                <button class="action-button" 
                        onclick="refreshData()" 
                        aria-label="Refresh organization data">
                    üîÑ Refresh Data
                </button>
            </div>
            
            <div id="projectsResult" class="result-container"></div>
            
            <div class="code-snippet">
                <strong>Backend Code (worker/app.ts):</strong><br>
                const groupsResponse = await client.projectsGroupsApi.withFetchAll().listGroups();<br>
                const projectsResponse = await client.projectsGroupsApi.withFetchAll().listProjects();<br>
                // Organize projects by their group ID
            </div>
        </div>

        <!-- API Reference Section -->
        <div class="tool-section" role="region" aria-labelledby="api-reference-heading">
            <h3 id="api-reference-heading">üìö Available Crowdin Apps JS API Methods</h3>
            <table class="data-table" role="table" aria-label="Crowdin Apps JS API methods reference">
                <thead>
                    <tr>
                        <th>Method</th>
                        <th>Description</th>
                        <th>Usage</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>AP.getContext(callback)</code></td>
                        <td>Get organization context information</td>
                        <td><span class="badge success">Used</span></td>
                    </tr>
                    <tr>
                        <td><code>AP.getJwtToken(callback)</code></td>
                        <td>Get JWT token for API calls</td>
                        <td><span class="badge success">Used</span></td>
                    </tr>
                    <tr>
                        <td><code>AP.redirect(path)</code></td>
                        <td>Navigate to different Crowdin page</td>
                        <td><span class="badge info">Available</span></td>
                    </tr>
                    <tr>
                        <td><code>AP.events.on(event, callback)</code></td>
                        <td>Listen to Crowdin events</td>
                        <td><span class="badge info">Available</span></td>
                    </tr>
                </tbody>
            </table>
            
            <p style="margin-top: 15px;">
                üìñ <strong>Full API Documentation:</strong> 
                <a href="https://support.crowdin.com/developer/crowdin-apps-js" target="_blank">
                    https://support.crowdin.com/developer/crowdin-apps-js
                </a>
            </p>
        </div>

        <!-- Implementation Guide -->
        <div class="tool-section">
            <h3>üîß Implementation Guide</h3>
            
            <h4>Frontend (app.js):</h4>
            <div class="code-snippet">
                ‚Ä¢ Use <code>AP.getContext()</code> to get organization information<br>
                ‚Ä¢ Use <code>AP.getJwtToken()</code> to authenticate API calls<br>
                ‚Ä¢ Make requests to your backend endpoints with JWT token<br>
                ‚Ä¢ Update UI based on responses
            </div>

            <h4>Backend (worker/app.ts):</h4>
            <div class="code-snippet">
                ‚Ä¢ Initialize Crowdin SDK with <code>addCrowdinEndpoints()</code><br>
                ‚Ä¢ Use <code>establishCrowdinConnection(jwt)</code> to authenticate<br>
                ‚Ä¢ Access Crowdin API via <code>client.projectsGroupsApi</code>, <code>client.groupsApi</code>, etc.<br>
                ‚Ä¢ Return data to frontend via Express endpoints
            </div>

            <h4>Next Steps:</h4>
            <ul class="feature-list">
                <li>Update app configuration in <code>worker/app.ts</code> (name, identifier, description)</li>
                <li>Customize the UI in <code>index.html</code> and <code>styles.css</code></li>
                <li>Add your business logic in <code>app.js</code></li>
                <li>Create new API endpoints in <code>worker/app.ts</code></li>
                <li>Test your app in Crowdin organization</li>
                <li>Deploy to Cloudflare Workers and install it in your Crowdin account</li>
            </ul>

            <div class="info-box">
                <strong>üéØ Pro Tips:</strong><br>
                ‚Ä¢ Organization Menu apps have access to all organization projects and groups<br>
                ‚Ä¢ Use the Crowdin API efficiently - cache data when possible<br>
                ‚Ä¢ Handle errors gracefully and show user-friendly messages<br>
                ‚Ä¢ Test with different organization sizes and configurations
            </div>
        </div>

    </div>
</body>
</html>
